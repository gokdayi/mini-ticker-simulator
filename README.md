### Mini Crypto Ticker Simulator
> This is a simple cryptocurrency ticker app that fetches data from OKX API via a web socket. It then saves the incoming data to a MongoDB instance asynchronously. This was an interview project & I implemented it in a couple of hours. **NOT** ready for production!

### How to run?
- Install all the npm packages
- Create a `.env` file with a variable named `MONGO_URI` which points to your mongo URL, I am using a cloud atlas instance on my localhost
- Run `npm run dev`  

### Description

By inspecting the `app.js`, you can get a quick overview of what the app is trying to do. Specifically;

- Tries to connect to the Mongo instance first
- If the connection to the DB is successful, then it tries to start the `fastify` server & listens on port 3000
- Fetches instruments data asynchronously. In this case, it only fetches the three spot symbols; BTC, ETH & XRP
- Using the response data it then subscribes to the OKX WebSocket API by sending a parameter object like in the following;
```javascript
{
  "op": "subscribe",
  "args": [
    {
      "channel": "tickers",
      "instId": "LTC-USD-200327"
    }
  ]
}
```
[You can have a look at this link for more details](https://www.okx.com/docs-v5/en/#websocket-api-public-channel-instruments-channel)
- Whenever a message is received from the OKX API, it logs the response data to the console and then saves it in the database
- To access the saved data, just make a `GET` request to the following URL;
```javascript
http://localhost:3000/instruments/BTC
http://localhost:3000/instruments/ETH
http://localhost:3000/instruments/XRP
```

### Controllers
> There is a single controller, namely the `instruments.controller.js` It contains the following endpoints;

#### **getinstruments** - GET
- Returns the last 10 ticker items in the database
- Json schema as in the following;
```javascript
{
  data: [{
    ..ticker
  }]
}
```
- Returns an error object in case any internal error happens

#### **deleteall** - DELETE
- Deletes all the ticker records from the database, returns a `message` object in case it goes successfully 

### Logic
> There is a single repository function in the `logic/ticker.repo.js`, namely the `saveTickers(raw)` function which accepts raw data generated by the OKX SPOT API

#### **saveTickers** 
- Parses the raw data to JSON first
- Extracts the spot data array & iterates through the array
- For each spot object, extracts the symbol of the item & creates an object including other properties
- Saves the ticker object to the database

### Models

#### ticker
> There is a single model and a schema; `ticker`. It is pretty self-descriptive. Take a look at the following file for more details; 
`models/ticker.js`

### Routes

There are 2 routes;
- /instruments/:symbol   [GET] 
- /instruments/deleteall [DELETE]


### CONCLUSION

This a project developed in a couple of hours for an interview, so it is not well-tested. It is also dependent on a public API by OKX (it doesn't require a key) but there are limitations and terms are subject to change anytime. So, DO NOT use this code for production! Do your own research with OKX API.